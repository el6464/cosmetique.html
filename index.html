<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Belli et Bien Être</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<style>
body {font-family: Arial, sans-serif; margin:0; padding:0; background:#f5f5f5;}
header {background:#8bc34a; color:#fff; padding:15px; text-align:center; font-size:24px;}
nav {display:flex; justify-content:center; background:#c8e6c9;}
nav button {background:none; border:none; padding:15px 30px; cursor:pointer; font-size:16px;}
nav button.active {background:#aed581;}
.container {padding:20px;}
.products, .cart, .formulaire {display:none;}
.products.active, .cart.active, .formulaire.active {display:block;}
.product-item {background:#fff; padding:15px; margin-bottom:10px; border-radius:5px; display:flex; justify-content:space-between; align-items:center;}
button.add {background:#4caf50; color:#fff; border:none; padding:5px 10px; cursor:pointer;}
.cart-item {background:#fff; padding:10px; margin-bottom:5px; border-radius:5px; display:flex; justify-content:space-between; align-items:center;}
button.remove {background:#f44336; color:#fff; border:none; padding:3px 8px; cursor:pointer;}
button.qty {background:#03a9f4; color:#fff; border:none; padding:3px 8px; cursor:pointer;}
.cart-header {display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;}
.formulaire input, .formulaire select {width:100%; padding:8px; margin:5px 0;}
button.download, button.pay {background:#4caf50; color:#fff; border:none; padding:10px 15px; cursor:pointer; margin-top:10px;}
</style>
</head>
<body>

<header>Belli et Bien Être</header>
<nav>
  <button id="tabProducts" class="active">Produits (<span id="countProducts">0</span>)</button>
  <button id="tabCart">Panier</button>
</nav>

<div class="container">
  <!-- Onglet Produits -->
  <div class="products active" id="productsTab">
    <div class="product-item">
      <span>Crème hydratante</span>
      <span>10€</span>
      <button class="add" onclick="addToCart('Crème hydratante',10)">Ajouter</button>
    </div>
    <div class="product-item">
      <span>Shampoing bio</span>
      <span>8€</span>
      <button class="add" onclick="addToCart('Shampoing bio',8)">Ajouter</button>
    </div>
    <div class="product-item">
      <span>Huile essentielle</span>
      <span>12€</span>
      <button class="add" onclick="addToCart('Huile essentielle',12)">Ajouter</button>
    </div>
  </div>

  <!-- Onglet Panier -->
  <div class="cart" id="cartTab">
    <div class="cart-header">
      <span>Votre Panier</span>
      <button onclick="viderPanier()">Vider</button>
    </div>
    <div id="cartItems"></div>
    <div>
      <strong>Total: <span id="cartTotal">0</span>€</strong>
    </div>
    <button onclick="openForm()">Valider le panier</button>
  </div>

  <!-- Formulaire commande -->
  <div class="formulaire" id="formTab">
    <h3>Informations de commande</h3>
    <input type="text" id="nom" placeholder="Nom">
    <input type="text" id="prenom" placeholder="Prénom">
    <input type="text" id="adresse" placeholder="Adresse">
    <input type="text" id="telephone" placeholder="Téléphone">
    <input type="text" id="dateCommande" readonly>
    <input type="text" id="dateLivraison" readonly>
    <select id="modePaiement">
      <option value="Wave">Wave</option>
      <option value="Orange Money">Orange Money</option>
      <option value="Espèces">Espèces</option>
    </select>
    <button class="download" onclick="telechargerBonCommande()">Télécharger le bon de commande</button>
    <button class="pay" onclick="payer()">Valider et Payer</button>
  </div>
</div>

<script>
let panier = [];
let factureNum = 1;

// Onglets
const tabProducts = document.getElementById('tabProducts');
const tabCart = document.getElementById('tabCart');
const productsTab = document.getElementById('productsTab');
const cartTab = document.getElementById('cartTab');
const formTab = document.getElementById('formTab');
const countProducts = document.getElementById('countProducts');

tabProducts.addEventListener('click',()=>{switchTab('products');});
tabCart.addEventListener('click',()=>{switchTab('cart');});

function switchTab(tab){
  productsTab.classList.remove('active');
  cartTab.classList.remove('active');
  formTab.classList.remove('active');
  tabProducts.classList.remove('active');
  tabCart.classList.remove('active');

  if(tab==='products'){productsTab.classList.add('active'); tabProducts.classList.add('active');}
  if(tab==='cart'){cartTab.classList.add('active'); tabCart.classList.add('active');}
  if(tab==='form'){formTab.classList.add('active');}
}

// Ajouter produit
function addToCart(nom, prix){
  const exist = panier.find(p=>p.nom===nom);
  if(exist){exist.quantite++;} else {panier.push({nom, prix, quantite:1});}
  updateCart();
}

// Affichage panier
function updateCart(){
  const cartItems = document.getElementById('cartItems');
  cartItems.innerHTML='';
  let total =0;
  panier.forEach((p,index)=>{
    const div = document.createElement('div');
    div.className='cart-item';
    div.innerHTML=`${p.nom} - ${p.prix}€ x ${p.quantite} = ${p.prix*p.quantite}€
      <button class="qty" onclick="changeQty(${index},1)">+</button>
      <button class="qty" onclick="changeQty(${index},-1)">-</button>
      <button class="remove" onclick="removeItem(${index})">Supprimer</button>`;
    cartItems.appendChild(div);
    total += p.prix*p.quantite;
  });
  document.getElementById('cartTotal').innerText=total;
  countProducts.innerText=panier.reduce((a,p)=>a+p.quantite,0);
}

// Changer quantité
function changeQty(i, q){panier[i].quantite+=q; if(panier[i].quantite<=0)panier.splice(i,1); updateCart();}

// Supprimer
function removeItem(i){panier.splice(i,1); updateCart();}
function viderPanier(){panier=[]; updateCart();}

// Formulaire
function openForm(){
  if(panier.length===0){alert("Panier vide!"); return;}
  switchTab('form');
  const today = new Date();
  document.getElementById('dateCommande').value = today.toISOString().split('T')[0];
  let liv = new Date();
  liv.setDate(today.getDate()+3);
  document.getElementById('dateLivraison').value = liv.toISOString().split('T')[0];
}

// PDF
function telechargerBonCommande(){
  if(panier.length===0){alert("Panier vide !"); return;}
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();

  doc.setFontSize(18);
  doc.text("Belli et Bien Être", 105, 15, null, null, "center");
  doc.setFontSize(12);
  doc.text(`Nom: ${document.getElementById("nom").value}`,10,30);
  doc.text(`Prénom: ${document.getElementById("prenom").value}`,10,40);
  doc.text(`Adresse: ${document.getElementById("adresse").value}`,10,50);
  doc.text(`Téléphone: ${document.getElementById("telephone").value}`,10,60);
  doc.text(`Date commande: ${document.getElementById("dateCommande").value}`,10,70);
  doc.text(`Date livraison: ${document.getElementById("dateLivraison").value}`,10,80);
  doc.text(`Mode paiement: ${document.getElementById("modePaiement").value}`,10,90);

  let startY=100;
  doc.text("Produit      Prix      Qté      Total",10,startY);
  let total=0;
  panier.forEach(p=>{
    startY+=10;
    doc.text(`${p.nom}      ${p.prix}€      ${p.quantite}      ${p.prix*p.quantite}€`,10,startY);
    total+=p.prix*p.quantite;
  });
  startY+=10;
  doc.text(`Total: ${total}€`,10,startY);
  doc.text(`Facture N°: ${factureNum}`,10,startY+10);

  doc.save(`Bon_de_commande_${Date.now()}.pdf`);
}

// Paiement (exemple redirection)
function payer(){
  if(document.getElementById("modePaiement").value==="Espèces"){
    alert("Commande validée, paiement en espèces.");
  } else if(document.getElementById("modePaiement").value==="Wave"){
    window.open("https://www.wave.com/pay","_blank");
  } else if(document.getElementById("modePaiement").value==="Orange Money"){
    window.open("https://www.orangemoney.com/pay","_blank");
  }
  factureNum++;
  panier=[];
  updateCart();
  switchTab('products');
}
</script>
</body>
</html>
