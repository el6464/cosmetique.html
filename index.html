<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Belli et Bien Être - Boutique</title>
<style>
body {
    font-family: Arial, sans-serif;
    background-color: #f2f2f2;
    margin: 0;
}
header {
    background-color: #4CAF50;
    color: white;
    padding: 15px;
    display: flex;
    align-items: center;
    justify-content: space-between;
}
header img { height: 50px; }
.products, #panier, #facture {
    padding: 20px;
}
.products {
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
}
.product {
    background-color: white;
    padding: 15px;
    border-radius: 5px;
    width: 200px;
    box-shadow: 0 0 5px #aaa;
}
button {
    padding: 5px 10px;
    margin-top: 5px;
}
#panier {
    position: fixed;
    right: 20px;
    top: 80px;
    width: 300px;
    background-color: white;
    border: 1px solid #aaa;
    border-radius: 5px;
    display: none;
    z-index: 1000;
}
#panier h3 {
    margin: 0;
    padding: 10px;
    background-color: #4CAF50;
    color: white;
    border-radius: 5px 5px 0 0;
}
#panier table {
    width: 100%;
    border-collapse: collapse;
}
#panier table, #panier th, #panier td {
    border: 1px solid #ccc;
}
#panier th, #panier td {
    padding: 5px;
    text-align: center;
}
#formCommande {
    background-color: white;
    padding: 20px;
    margin-top: 20px;
    border-radius: 5px;
    box-shadow: 0 0 5px #aaa;
}
#formCommande input, #formCommande select {
    width: 100%;
    padding: 5px;
    margin: 5px 0;
}
#facture {
    display: none;
    background-color: white;
    padding: 20px;
    margin-top: 20px;
    border-radius: 5px;
    box-shadow: 0 0 5px #aaa;
}
#facture table {
    width: 100%;
    border-collapse: collapse;
}
#facture table, #facture th, #facture td {
    border: 1px solid #ccc;
}
#facture th, #facture td {
    padding: 8px;
    text-align: left;
}
</style>
</head>
<body>

<header>
    <img src="logo.png" alt="Logo Belli et Bien Être">
    <div>
        <button id="ouvrirPanier">Panier (<span id="nbProduits">0</span>)</button>
    </div>
</header>

<div class="products">
    <div class="product">
        <h4>Produit A</h4>
        <p>Prix: 10€</p>
        <button onclick="ajouterAuPanier('Produit A', 10)">Ajouter</button>
    </div>
    <div class="product">
        <h4>Produit B</h4>
        <p>Prix: 15€</p>
        <button onclick="ajouterAuPanier('Produit B', 15)">Ajouter</button>
    </div>
    <div class="product">
        <h4>Produit C</h4>
        <p>Prix: 20€</p>
        <button onclick="ajouterAuPanier('Produit C', 20)">Ajouter</button>
    </div>
</div>

<div id="panier">
    <h3>Votre Panier</h3>
    <table id="tablePanier">
        <thead>
            <tr>
                <th>Produit</th>
                <th>Prix</th>
                <th>Qté</th>
                <th>Total</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
    <p>Total: <span id="totalPanier">0</span>€</p>
    <button onclick="afficherFormCommande()">Valider commande</button>
</div>

<div id="formCommande">
    <h3>Formulaire de commande</h3>
    <form id="commandeForm">
        <input type="text" id="nom" placeholder="Nom" required>
        <input type="text" id="prenom" placeholder="Prénom" required>
        <input type="text" id="adresse" placeholder="Adresse" required>
        <input type="tel" id="telephone" placeholder="Téléphone" required>
        <input type="text" id="dateCommande" readonly>
        <input type="text" id="dateLivraison" readonly>
        <select id="modePaiement" required>
            <option value="">-- Choisir le mode de paiement --</option>
            <option value="Wave">Wave</option>
            <option value="Orange Money">Orange Money</option>
            <option value="Espèces">Espèces</option>
        </select>
        <button type="submit">Confirmer et Payer</button>
    </form>
</div>

<div id="facture">
    <h3>Facture - Belli et Bien Être</h3>
    <p>Adresse boutique: 123 Rue du Bien-être, Saint-Étienne</p>
    <p>Téléphone: 06 12 34 56 78</p>
    <p>Numéro facture: <span id="numFacture"></span></p>
    <p>Nom: <span id="factNom"></span></p>
    <p>Prénom: <span id="factPrenom"></span></p>
    <p>Adresse: <span id="factAdresse"></span></p>
    <p>Téléphone: <span id="factTel"></span></p>
    <p>Date commande: <span id="factDateCommande"></span></p>
    <p>Date livraison: <span id="factDateLivraison"></span></p>
    <h4>Détails des produits</h4>
    <table id="tableFacture">
        <thead>
            <tr>
                <th>Produit</th>
                <th>Prix</th>
                <th>Qté</th>
                <th>Total</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
    <p>Total: <span id="factTotal"></span>€</p>
</div>

<script>
let panier = [];

function ajouterAuPanier(nom, prix){
    const index = panier.findIndex(p => p.nom === nom);
    if(index > -1){
        panier[index].quantite++;
    } else {
        panier.push({nom, prix, quantite: 1});
    }
    afficherPanier();
}

function afficherPanier(){
    const tbody = document.querySelector("#tablePanier tbody");
    tbody.innerHTML = "";
    let total = 0;
    panier.forEach((p, i)=>{
        const row = document.createElement("tr");
        row.innerHTML = `
            <td>${p.nom}</td>
            <td>${p.prix}€</td>
            <td>
                <button onclick="modifierQté(${i}, -1)">-</button>
                ${p.quantite}
                <button onclick="modifierQté(${i}, 1)">+</button>
            </td>
            <td>${p.prix * p.quantite}€</td>
            <td><button onclick="supprimerProduit(${i})">Supprimer</button></td>
        `;
        tbody.appendChild(row);
        total += p.prix * p.quantite;
    });
    document.getElementById("totalPanier").innerText = total;
    document.getElementById("nbProduits").innerText = panier.reduce((sum,p)=>sum+p.quantite,0);
    document.getElementById("panier").style.display = "block";
}

function modifierQté(index, delta){
    panier[index].quantite += delta;
    if(panier[index].quantite <= 0){
        panier.splice(index, 1);
    }
    afficherPanier();
}

function supprimerProduit(index){
    panier.splice(index,1);
    afficherPanier();
}

document.getElementById("ouvrirPanier").addEventListener("click", ()=>{
    const panierDiv = document.getElementById("panier");
    panierDiv.style.display = panierDiv.style.display === "block" ? "none" : "block";
});

// fermer panier si clic en dehors
document.addEventListener("click", function(e){
    const panierDiv = document.getElementById("panier");
    const btnPanier = document.getElementById("ouvrirPanier");
    if(panierDiv.style.display === "block" &&
       !panierDiv.contains(e.target) && e.target !== btnPanier){
        panierDiv.style.display = "none";
    }
});

// formulaire commande
function afficherFormCommande(){
    if(panier.length === 0){
        alert("Votre panier est vide !");
        return;
    }
    document.getElementById("formCommande").style.display = "block";

    const today = new Date();
    const livraison = new Date();
    livraison.setDate(today.getDate() + 3);

    document.getElementById("dateCommande").value = today.toLocaleDateString();
    document.getElementById("dateLivraison").value = livraison.toLocaleDateString();
}

document.getElementById("commandeForm").addEventListener("submit", function(e){
    e.preventDefault();
    if(panier.length === 0){
        alert("Votre panier est vide !");
        return;
    }
    const nom = document.getElementById("nom").value;
    const prenom = document.getElementById("prenom").value;
    const adresse = document.getElementById("adresse").value;
    const tel = document.getElementById("telephone").value;
    const dateCommande = document.getElementById("dateCommande").value;
    const dateLivraison = document.getElementById("dateLivraison").value;
    const paiement = document.getElementById("modePaiement").value;

    if(!paiement){
        alert("Choisissez un mode de paiement !");
        return;
    }

    // générer numéro facture
    const numFacture = "BEB-" + Date.now();

    // remplir la facture
    document.getElementById("numFacture").innerText = numFacture;
    document.getElementById("factNom").innerText = nom;
    document.getElementById("factPrenom").innerText = prenom;
    document.getElementById("factAdresse").innerText = adresse;
    document.getElementById("factTel").innerText = tel;
    document.getElementById("factDateCommande").innerText = dateCommande;
    document.getElementById("factDateLivraison").innerText = dateLivraison;

    const tbodyFact = document.querySelector("#tableFacture tbody");
    tbodyFact.innerHTML = "";
    let total = 0;
    panier.forEach(p=>{
        const row = document.createElement("tr");
        row.innerHTML = `<td>${p.nom}</td><td>${p.prix}€</td><td>${p.quantite}</td><td>${p.prix*p.quantite}€</td>`;
        tbodyFact.appendChild(row);
        total += p.prix * p.quantite;
    });
    document.getElementById("factTotal").innerText = total;
    document.getElementById("facture").style.display = "block";

    // sauvegarder la commande localStorage
    let commandes = JSON.parse(localStorage.getItem("commandes") || "[]");
    commandes.push({
        numFacture, nom, prenom, adresse, tel, dateCommande, dateLivraison, paiement, produits: panier
    });
    localStorage.setItem("commandes", JSON.stringify(commandes));

    // redirection paiement
    if(paiement === "Wave"){
        window.open("https://www.wave.com/pay", "_blank");
    } else if(paiement === "Orange Money"){
        window.open("https://www.orangemoney.com/pay", "_blank");
    } else {
        alert("Paiement en espèces, commande confirmée !");
    }

    // vider panier
    panier = [];
    afficherPanier();
    document.getElementById("formCommande").style.display = "none";
});
</script>

</body>
</html>
